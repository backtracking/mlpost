\documentclass[twoside]{article}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{actes,alltt,url,graphicx}
\usepackage[french]{babel}

%; whizzy -pdf .

% macros
\newcommand{\mlpost}{\textsc{Mlpost}}
\newcommand{\metapost}{\textsc{MetaPost}}
\newcommand{\fmpost}{\textit{functional} \metapost}
\newcommand{\metafont}{\textsc{Metafont}}
\newcommand{\tikz}{\textsc{Tikz}}
\newcommand{\pstricks}{\textsc{Pstricks}}
\newcommand{\dia}{\textsc{Dia}}
\newcommand{\xfig}{\textsc{Xfig}}

\title{Faire bonne figure avec \mlpost}

\author{R. Bardou$^1$
        \& J. Kanig$^1$
        \& J.-C. Filliâtre$^1$
        \& S. Lescuyer$^1$}

\titlehead{Faire bonne figure avec \mlpost}%  a droite (page impaire)

\authorhead{Bardou \& Kanig \& Filliâtre \& Lescuyer}% a gauche (page paire)

\affiliation{\begin{tabular}{rr} 
\\ 1:  ProVal / INRIA Saclay -- Île-de-France
\\     91893 Orsay Cedex, France
\\     LRI / CNRS -- Université Paris Sud
\\     91405 Orsay Cedex, France
\\     {\tt \{bardou,kanig,filliatr,lescuyer\}@lri.fr} 
\end{tabular}}

\begin{document}
\setcounter{page}{1}
\maketitle

\begin{abstract}
  
\end{abstract}

\section{Introduction}

% justifier la nécessité d'un bon mariage avec LaTeX

Il existe plusieurs familles d'outils pour réaliser des figures à
intégrer dans un document \LaTeX~:
\begin{itemize}
\item des interfaces graphiques disposant d'une sortie \LaTeX, telles
  que \dia~\cite{dia} ou \xfig~\cite{xfig} ;
\item des bibliothèques \LaTeX, telles que \pstricks~\cite{pstricks}
  ou encore \tikz~\cite{tikz} ; 
\item des outils externes en ligne de commande, tel 
  \metapost~\cite{metapost}.
\end{itemize}

Chaque famille a ses avantages et ses inconvénients. Les interfaces
graphiques sont les plus accessibles, notamment pour un placement
rapide et intuitif des différents éléments de la figure, mais
l'intégration de texte mis en forme par \LaTeX\ est délicate. Dans le
cas de \xfig\ et de \dia, la taille des éléments \LaTeX\ n'est pas
connue lors de l'édition de la figure ; en outre, 
dans le cas de \dia, l'intégration de \LaTeX\ dans une figure
nécessite de l'exporter sous forme de macros \tikz\ et d'éditer le résultat.

Les bibliothèques \LaTeX\ telles que \pstricks\ ou \tikz\ offrent
l'intégration la plus naturelle avec \LaTeX. En particulier, elles
permettent de combiner arbitrairement éléments graphiques et textes \LaTeX.
% TODO un exemple en ligne ici ?
En revanche, elles demandent d'apprendre un certain nombre de macros
et de notations et souffrent surtout des défauts inhérents à \LaTeX~:
\begin{itemize}
\item des erreurs détectées uniquement à
  l'interprétation, peu claires et parfois mal localisées ;
\item un langage \emph{de programmation} peu commode (syntaxe obscure,
  absence de typage, code difficile à structurer).
\end{itemize}
Ces inconvénients sont notamment un frein au développement de
bibliothèques de haut niveau au dessus de ces langages ainsi qu'à la
réutilisation de figures.

\metapost\ se présente comme une alternative à ces bibliothèques
\LaTeX, en proposant un langage de programmation à part entière
spécialisé dans la construction de figures contenant des éléments
\LaTeX. Il permet notamment de manipuler symboliquement la taille et
la position de ces éléments et de les relier de manière implicite par
des équations. En revanche, le langage de \metapost\ s'inspire de
celui de \metafont~\cite{metafont} et présente, à l'exception de la
syntaxe, les défauts soulevés ci-dessus.
% TODO  exemple metapost ?


\fmpost

% motivation (dessiner en programmant, inclusion latex)

%%% PROS

% ne pas apprendre un nouveau langage

% LaTeX = pas un langage de programmation

% avec Caml : on bénéficie du typage de Caml, on dispose de tout le langage

%%% CONS

% pas de baseline

% pas de mélange entre LaTeX et les graphiques

\subsection{Les solutions existantes}

Il existent de nombreuses solutions pour des dessins techniques. Tout d'abord,
les logiciels à base d'interface graphique, notamment {\em dia} et {\em xfig}.
Ces deux programmes permettent la création à la souris de dessins plus ou
moins complexes. Ils ont l'avantage d'être assez intuitifs, mais ils partagent
aussi l'absence d'inclusion de \LaTeX\ dans un dessin. Avec xfig, on peut
néanmoins mettre du code \LaTeX\ dans un document, mais sa taille réelle ne
pourra être prise en compte. Dia n'offre même pas cette possibilité, il faut
éditer les fichiers de sortie, si on veut vraiment mettre du code \LaTeX.

Les solutions à base de langages de programmation intègrent toutes une bon
support pour du texte en \LaTeX. Nous en citons les plus connus.

\begin{itemize}
  \item {\em pstricks} est un ensemble de macros \LaTeX. Même si c'est
    relativement puissant, son utilisation est assez lourde et non-intuitive.
  \item tikz
  \item metapost
  \item mlpictex
  \item functional metapost
\end{itemize}<++>


solutions existantes:

\cite{metapost}

\section{Principes et exemples}

choix de la persistance

placement relatif plutôt qu'absolu

% automate -- RB
\begin{minipage}{0.2\linewidth}
  \includegraphics{automate.mps}
\end{minipage}
\begin{minipage}{0.2\linewidth}
\small\begin{ocaml}
open Num
let automate =
  let etat = Box.tex ~style: Circle in
  let final = Box.box ~style: Circle ~dx:zero ~dy:zero in
  let etats = Box.vbox ~padding: (cm 0.8) [
    Box.hbox ~padding: (cm 1.4) [ etat "$\\alpha$"; etat "$\\beta$" ];
    final (etat "$\\gamma$");
  ]in
  let alpha = nth 0 (nth 0 etats) in
  let beta = nth 1 (nth 0 etats) in
  let gamma = nth 1 etats in [
    Box.draw etats;
    Arrow.draw ~tex: "a" ~pos: `Lowleft (cpath alpha gamma);
    Arrow.draw ~tex: "b" ~pos: `Lowright (cpath gamma beta);
    Arrow.draw ~tex: "c" ~pos: `Top
      (cpath ~outd: (vec (dir 25.)) ~ind: (vec (dir 335.)) alpha beta);
    Arrow.draw ~tex: "d" ~pos: `Bot
      (cpath ~outd: (vec (dir 205.)) ~ind: (vec (dir 155.)) beta alpha);
    Arrow.draw ~tex: "e" ~pos: `Bot (loop gamma);
    let w = Box.west alpha in
    Arrow.draw (Path.pathp [ Point.shift w (Point.pt (cm (-0.3), zero)); w ]);
  ]
\end{ocaml}
\end{minipage}

% blocs mémoire (listes, etc.) -- JCF

% diagramme simple -- JK

% diagramme UML -- JK
\begin{minipage}{0.3\linewidth}
  \includegraphics{uml.mps}
\end{minipage}
\begin{minipage}{0.3\linewidth}
\small\begin{ocaml}
let uml = 
  let classblock name attr_list method_list = 
    let tex = Box.tex ~stroke:None in
    let vbox = Box.vbox ~pos:`Left in
      Box.vblock ~pos:`Left ~name
      [ tex ("{\\bf " ^ name ^ "}");
        vbox (List.map tex attr_list); vbox (List.map tex method_list) ]
  in
  let a = classblock "BankAccount" 
            [ "balance : Dollars = $0$"] 
            ["deposit (amount : Dollars)"; "withdraw (amount : Dollars)" ] 
  in
  let b = classblock "Client" ["name : String"; "address : String" ] [] in
  let diag = Box.vbox ~padding:(Num.bp 50.) [a;b] in
  [ Box.draw diag; 
    box_label_arrow ~pos:`Left (Picture.tex "owns") 
      (get "Client" diag) (get "BankAccount" diag) ]
\end{ocaml}
\end{minipage}

% arbre -- JCF

% plot -- SL

\begin{minipage}{0.3\linewidth}
  \includegraphics{graph_sqrt.mps}
\end{minipage}
\begin{minipage}{0.3\linewidth}
\small\begin{ocaml}
let graph_sqrt =
  let u = cm 1. in
  let sk = Plot.mk_skeleton 4 2 u u in
  let label = Picture.tex "$\\sqrt x$", `Top, 3 in
  let graph = Plot.draw_func ~label (fun x -> sqrt (float x)) sk in
    [graph; Plot.draw_simple_axes "$x$" "$y$" sk]
\end{ocaml}
\end{minipage}

% exemples utilisant des calculs en Caml

% bresenham -- JCF

% exemples Florence et Yannick (sans le code)

\section{Architecture logicielle}

% schéma de l'architecture
\begin{figure}[h]
  \begin{center}
    \includegraphics{architecture.mps}
  \end{center}
  \caption{Architecture de \mlpost}
\end{figure}

\subsection{Types primitifs de \metapost}

API
compilation, hashconsing
modules récursifs - interface de MlPost

\subsection{Boîtes}

- principe récursif : boîte = picture ou ensemble de boîtes + contour
+ fond

- boîtes primitives
- réunion, alignements

\subsubsection{Application : arbres}

\subsection{Flèches} %%% RB

\section{Conclusion}

% pas fait / à faire

résolution d'équations

perspectives infinies d'extensions : 3D, animations, ...
plus facile de le faire en Caml qu'en \metapost\ ou en \LaTeX\ (\tikz,
\pstricks) 

plein de sortes de flèches

\paragraph{Remerciements.} Les auteurs tiennent à remercier Florence
Plateau, Yannick Moy et Claude Marché pour leur contribution à \mlpost.

% La bibliographie
% N'oubliez pas de l'inclure lors de votre soumission.
\bibliographystyle{plain}
\bibliography{./biblio}

\vfill

\pagebreak
\thispagestyle{colloquetitle}
\cleardoublepage
\end{document}

% Local Variables:
% coding: iso-latin-1
% ispell-local-dictionary: "francais"
% End:
